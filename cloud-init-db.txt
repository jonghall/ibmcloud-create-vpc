#cloud-config
package-update: true
package_upgrade: true
apt:
  primary:
    - arches: [default]
      uri:  http://mirrors.adn.networklayer.com/ubuntu

packages:
- locales
- build-essential
- acl
- ntp
- htop
- git
- supervisor
- python3
- python-pip
- python3-pip
- mysql-client
- mysql-server
- python3-pymysql

mounts:
 - [ /dev/vdb1, /var/lib/mysql, "ext4", "defaults,nofail", "0", "2" ]

disk_setup:
    /dev/vdb:
        table_type: 'gpt'
        layout: true
        overwrite: true

fs_setup:
    - label: None
      filesystem: 'ext4'
      device: '/dev/vdb1'
      partition: 'auto'

power_state:
 mode: reboot
 message: Rebooting server now.
 timeout: 30
 condition: True