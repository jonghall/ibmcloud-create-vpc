- vpc: wtvpc
  region: us-south
  generation: 2
  resource_group: vpc_sandbox
  instanceTemplates:
    - template: webapp_server
      image: 100GB - Ubuntu / Ubuntu / 16.04-64 Minimal for VSI
      profile_name: cc1-2x4
      sshkey: jonhall
      cloud-init-file: cloud-init-webapp.txt
    - template: db_server
      image: 100GB - Ubuntu / Ubuntu / 16.04-64 Minimal for VSI
      profile_name: cc1-2x4
      sshkey: jonhall
      cloud-init-file: cloud-init-db.txt
      bandwidth: 25000
      volumes:
        - capacity: 100
          profile: general-purpose
          delete_volume_on_instance_delete: true
  zones:
    - name: us-south-1
      address_prefix_cidr: 172.18.0.0/21
      subnets:
        - name: wtvpc-webapptier-us-south-1
          ipv4_cidr_block: 172.18.0.0/24
          publicGateway: true
          instances:
            - name: webapp%02d
              quantity: 1
              template: webapp_server
              floating_ip: true
              security_group: wtvpc-webapptier-sg
        - name: wtvpc-dbtier-us-south-1
          ipv4_cidr_block: 172.18.1.0/24
          publicGateway: true
          instances:
            - name: db%02d
              quantity: 1
              template: db_server
              floating_ip: true
              security_group: wtvpc-dbtier-sg
    - name: us-south-2
      address_prefix_cidr: 172.18.8.0/21
      subnets:
        - name: wtvpc-webapptier-us-south-2
          ipv4_cidr_block: 172.18.8.0/24
          publicGateway: true
          instances:
            - name: webapp%02d
              quantity: 1
              template: webapp_server
              floating_ip: true
              security_group: wtvpc-webapptier-sg
        - name: wtvpc-dbtier-us-south-2
          ipv4_cidr_block: 172.18.9.0/24
          publicGateway: true
          instances:
            - name: db%02d
              quantity: 1
              template: db_server
              floating_ip: true
              security_group: wtvpc-dbtier-sg
  security_groups:
    - security_group: wtvpc-webapptier-sg
      rules:
        - direction: inbound
          ip_version: ipv4
          protocol: all
          remote:
            cidr_block: 172.18.0.0/24
        - direction: inbound
          ip_version: ipv4
          protocol: all
          remote:
            cidr_block: 172.18.8.0/24
        - direction: inbound
          ip_version: ipv4
          protocol: all
          remote:
            cidr_block: 24.252.30.9/32
        - direction: outbound
          ip_version: ipv4
          protocol: all
          remote:
            cidr_block: 0.0.0.0/0
    - security_group: wtvpc-dbtier-sg
      rules:
        - direction: inbound
          ip_version: ipv4
          protocol: all
          remote:
            cidr_block: 172.18.1.0/24
        - direction: inbound
          ip_version: ipv4
          protocol: all
          remote:
            cidr_block: 172.18.9.0/24
        - direction: inbound
          ip_version: ipv4
          protocol: all
          remote:
            cidr_block: 24.252.30.9/32
        - direction: inbound
          ip_version: ipv4
          port_min: 3306
          port_max: 3306
          protocol: tcp
          remote:
            security_group: wtvpc-webapptier-sg
        - direction: outbound
          ip_version: ipv4
          protocol: all
          remote:
            cidr_block: 0.0.0.0/0
  sshkeys:
    - sshkey: jonhall
      public_key: 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDQ6H4W/5PCtVb6BEgbxNdgDbrJsAFD/Y13mz+qVhM6kHmoOBu5tbbQh7LGfCjpHzZ2A59m2i3zpFNwA9r06UErIfG8U020QAnirrmpo1qqB9tMI7BRSyvf5NFXnUklyszQSsXxxM6eYiQLiHDNnVN7Qyzgq5YcZ8eb559KzmyretdPulEBQvWKZyUbE03kX8ScNTI87p/jX/464viudryjtLgUNuJoFtCCYdoolvnNZsAq3wBl9LOgNaT33nP1ys1R4azG3pC921WX5+g4txws7tVzjPB/e5caOYdGXbFnYi2TXY3agX0wCNj/p/nPEO29c7s7kzEZN9o8ygSrj+Yn'
